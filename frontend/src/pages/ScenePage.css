.sp-wrap{
  padding: 18px 18px 26px;
}

.sp-titleBlock{
  margin: 6px 0 14px;
}

.sp-titleRow{
  display:flex;
  align-items:flex-start;
  justify-content: space-between;
  gap: 14px;
}

.sp-goBtn{
  appearance: none;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.90);
  border-radius: 14px;
  padding: 10px 14px;
  font-weight: 900;
  text-transform: lowercase;
  cursor: pointer;
  min-width: 120px;
  box-shadow: 0 14px 40px rgba(0,0,0,0.35);
}

.sp-goBtn:hover{ background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.18); }

.sp-title{
  font-size: 44px;
  font-weight: 800;
  letter-spacing: -0.02em;
  color: rgba(255,255,255,0.90);
}

.sp-sub{
  margin-top: 6px;
  font-size: 14px;
  color: rgba(255,255,255,0.60);
}

.sp-grid{
  display: grid;
  grid-template-columns: 1fr 0.9fr 1fr;
  gap: 14px;
  align-items: stretch;
}

/* When details sidebar is open we add one more column and lock other areas */
.sp-grid.hasDetailsModel{
  grid-template-columns: 1fr 0.42fr 0.9fr 1fr;
}
.sp-grid.hasDetailsLocation{
  grid-template-columns: 1fr 0.9fr 0.42fr 1fr;
}
.sp-grid.isDetailsLocked .sp-card{
  pointer-events: none;
  /* dim everything except details + confirm */
  opacity: 0.28;
  filter: saturate(0.75);
}
.sp-grid.isDetailsLocked .sp-detailsSidebar{
  pointer-events: auto;
  opacity: 1;
  filter: none;
}

.sp-card{
  background: rgba(10,14,26,0.55);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 18px;
  box-shadow: 0 14px 40px rgba(0,0,0,0.38);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

/* Details sidebar (between columns) */
.sp-detailsSidebar{
  background: rgba(10,14,26,0.62);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 18px;
  box-shadow: 0 14px 40px rgba(0,0,0,0.40);
  overflow: hidden;
  padding: 10px;
  display: flex;
  flex-direction: column;
  min-height: 0;
  height: 100%;
}
.sp-detailsHead{
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
  margin-bottom: 10px;
}
.sp-detailsTitle{
  font-weight: 800;
  font-size: 13px;
  color: rgba(255,255,255,0.86);
}
.sp-detailsSlots{
  display:flex;
  flex-direction: column;
  gap: 8px;
  flex: 1 1 auto;
  overflow: hidden; /* NO SCROLL like reference */
  padding-right: 0;
}
.sp-detailsSlot{
  position: relative;
  display:flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 10px;
  border-radius: 14px;
  border: 1px dashed rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.03);
  cursor: pointer;
  /* make sidebar height match other cards: 5 slots share available height */
  flex: 1 1 0;
  min-height: 0;
}
.sp-detailsSlot:hover{
  border-color: rgba(255,255,255,0.26);
  background: rgba(255,255,255,0.05);
}

.sp-slotMenuInline{
  position: absolute;
  min-width: 160px;
  left: -6px;
  right: -6px;
  top: 46px;
  z-index: 9999;
  padding: 8px;
  border-radius: 14px;
  background: rgba(12,16,26,0.96);
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 18px 45px rgba(0,0,0,0.55);
}
.sp-slotMenuInline button{
  width: 100%;
  text-align: left;
  padding: 10px 10px;
  border-radius: 10px;
  background: transparent;
  border: 0;
  color: rgba(255,255,255,0.86);
  cursor: pointer;
  font-weight: 800;
}
.sp-slotMenuInline button:hover{ background: rgba(255,255,255,0.07); }
.sp-slotMenuInline button:disabled{ opacity: 0.45; cursor: not-allowed; }
.sp-detailsSlotPreview{
  width: 100%;
  height: 44px;
  border-radius: 12px;
  border: 0;
  background: transparent; /* no "window in window" */
  overflow: hidden;
  display:flex;
  align-items:center;
  justify-content:center;
}
.sp-detailsSlotPreview img{
  width:100%;
  height:100%;
  object-fit: cover;
  display:block;
}
.sp-detailsSlotPlus{ font-size: 28px; font-weight: 900; color: rgba(255,255,255,0.35); }
.sp-detailsSlotLabel{
  position: absolute;
  left: 10px;
  right: 10px;
  font-size: 12px;
  font-weight: 900;
  color: rgba(255,255,255,0.78);
  text-align:center;
  line-height: 1.05;
  pointer-events: none;
}
.sp-detailsSlotLabelTop{ top: 8px; }
.sp-detailsSlotLabelBottom{ bottom: 8px; opacity: 0.78; }

.sp-detailsActions{ display:flex; gap: 10px; margin-top: 10px; }

.sp-cardHead{
  display:flex;
  align-items:center;
  justify-content: space-between;
  padding: 14px 14px 10px;
  border-bottom: 1px solid rgba(255,255,255,0.06);
}

.sp-cardName{
  text-transform: lowercase;
  font-weight: 800;
  font-size: 18px;
  letter-spacing: 0.02em;
  color: rgba(255,255,255,0.85);
}

.sp-cardActions{ display:flex; gap: 8px; align-items:center; }

.sp-iconBtn{
  width: 34px;
  height: 34px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.85);
  cursor:pointer;
}
.sp-iconBtn:hover{ background: rgba(255,255,255,0.09); }

.sp-pillBtn{
  padding: 8px 10px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.82);
  cursor:pointer;
  font-weight: 700;
}
.sp-pillBtn:hover{ background: rgba(255,255,255,0.09); }
.sp-pillBtn:disabled{
  opacity: 0.45;
  cursor: not-allowed;
}
.sp-pillBtn.isActive{
  border-color: rgba(255, 92, 122, 0.55);
  box-shadow: 0 0 0 1px rgba(255, 92, 122, 0.18), 0 0 24px rgba(255, 92, 122, 0.25);
}
.sp-pillBtn.sp-pillGreen.isActive{
  border-color: rgba(66, 245, 176, 0.55);
  box-shadow: 0 0 0 1px rgba(66, 245, 176, 0.18), 0 0 24px rgba(66, 245, 176, 0.22);
}

.sp-pillGreen{ border-color: rgba(66, 245, 176, 0.22); }

.sp-preview{
  padding: 14px;
  min-height: 440px;
  display: flex;
  flex: 1 1 auto;
  position: relative;
}

.sp-progressOverlay{
  position: absolute;
  inset: 14px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.10);
  background: radial-gradient(120% 120% at 10% 10%, rgba(255,255,255,0.10), rgba(0,0,0,0.55));
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.06);
}

.sp-progressOverlay.isBlue{
  box-shadow: inset 0 0 0 1px rgba(70,130,255,0.16), 0 0 28px rgba(70,130,255,0.12);
}
.sp-progressOverlay.isGreen{
  box-shadow: inset 0 0 0 1px rgba(66,245,176,0.14), 0 0 28px rgba(66,245,176,0.10);
}

.sp-progressInner{
  width: min(92%, 420px);
  text-align: center;
  padding: 16px 16px 14px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.25);
}

.sp-progressTitle{
  font-weight: 900;
  letter-spacing: 0.02em;
  color: rgba(255,255,255,0.92);
  margin-top: 10px;
}

.sp-progressPhrase{
  margin-top: 8px;
  color: rgba(255,255,255,0.72);
  font-size: 13px;
  line-height: 1.35;
  min-height: 36px;
}

.sp-progressSpinner{
  width: 34px;
  height: 34px;
  border-radius: 50%;
  border: 2px solid rgba(255,255,255,0.18);
  border-top-color: rgba(255,255,255,0.70);
  margin: 0 auto;
  animation: spSpin 0.9s linear infinite;
}

.sp-progressDots{
  margin-top: 6px;
  display: inline-flex;
  gap: 6px;
  opacity: 0.75;
}
.sp-progressDots span{
  display: inline-block;
  transform: translateY(0);
  animation: spDot 1.1s ease-in-out infinite;
}
.sp-progressDots span:nth-child(2){ animation-delay: 0.18s; }
.sp-progressDots span:nth-child(3){ animation-delay: 0.36s; }

@keyframes spSpin{
  from{ transform: rotate(0deg); }
  to{ transform: rotate(360deg); }
}

@keyframes spDot{
  0%, 100%{ transform: translateY(0); opacity: 0.55; }
  50%{ transform: translateY(-4px); opacity: 1; }
}

.sp-empty{
  flex: 1 1 auto;
  min-height: 420px;
  border-radius: 16px;
  border: 2px dashed rgba(255,255,255,0.10);
  display:flex;
  align-items:center;
  justify-content:center;
  color: rgba(255,255,255,0.35);
  font-weight: 800;
  letter-spacing: 0.05em;
}

.sp-img{
  width: 100%;
  height: 100%;
  min-height: 420px;
  object-fit: contain;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.18);
}

.sp-bottomBar{
  display:flex;
  gap: 10px;
  padding: 12px 14px 14px;
}

.sp-btn{
  height: 44px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.88);
  font-weight: 800;
  cursor:pointer;
  flex: 1;
}
.sp-btn:hover{ background: rgba(255,255,255,0.09); }
.sp-btn:disabled{ opacity: 0.55; cursor: not-allowed; }

.sp-btnPrimary{
  background: rgba(70, 130, 255, 0.30);
  border-color: rgba(70, 130, 255, 0.45);
}
.sp-btnPrimary:hover{ background: rgba(70,130,255,0.38); }

.sp-btnGreen{
  background: rgba(66, 245, 176, 0.16);
  border-color: rgba(66, 245, 176, 0.26);
}
.sp-btnGreen:hover{ background: rgba(66,245,176,0.22); }

.sp-btnGhost{
  background: rgba(255,255,255,0.04);
}

.sp-cardChat{ padding-bottom: 14px; }
.sp-chatHint{
  padding: 14px 14px 10px;
  color: rgba(255,255,255,0.56);
  font-size: 13px;
}

.sp-textarea{
  margin: 0 14px;
  width: calc(100% - 28px);
  height: 160px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.18);
  color: rgba(255,255,255,0.88);
  padding: 12px 12px;
  resize: none;
  outline: none;
}
.sp-textareaSmall{
  height: 96px;
}
.sp-textarea::placeholder{ color: rgba(255,255,255,0.35); }

.sp-chatActions{
  padding: 12px 14px 6px;
  display:flex;
  justify-content: flex-end;
}

.sp-statusCard{
  margin: 10px 14px 0;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.14);
  padding: 12px;
}
.sp-statusTitle{
  font-weight: 900;
  text-transform: lowercase;
  color: rgba(255,255,255,0.80);
  margin-bottom: 8px;
}
.sp-statusText{ color: rgba(255,255,255,0.60); }
.sp-statusMeta{
  margin-top: 10px;
  display:flex;
  gap: 12px;
  flex-wrap: wrap;
  color: rgba(255,255,255,0.45);
  font-size: 12px;
}

.sp-cardChat.is-model{
  border-color: rgba(70, 130, 255, 0.22);
  box-shadow: 0 14px 44px rgba(20,60,120,0.30);
}
.sp-cardChat.is-location{
  border-color: rgba(66, 245, 176, 0.18);
  box-shadow: 0 14px 44px rgba(20,120,80,0.22);
}

.sp-modalOverlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  display:flex;
  align-items:center;
  justify-content:center;
  padding: 20px;
  z-index: 50;
}

.sp-modal{
  width: min(520px, 96vw);
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(10,14,26,0.92);
  box-shadow: 0 26px 80px rgba(0,0,0,0.65);
  overflow: auto;
  /* side panel feel */
  margin-left: auto;
  margin-right: 18px;
  max-height: calc(100vh - 70px);
}

.sp-modalHead{
  display:flex;
  justify-content: space-between;
  align-items:center;
  gap: 12px;
  padding: 14px 14px 10px;
  border-bottom: 1px solid rgba(255,255,255,0.08);
}
.sp-modalTitle{
  font-weight: 900;
  font-size: 20px;
  color: rgba(255,255,255,0.90);
}
.sp-modalSub{ color: rgba(255,255,255,0.55); font-size: 12px; margin-top: 4px; }

.sp-tabs{
  display:flex;
  gap: 8px;
  padding: 12px 14px 0;
}
.sp-tab{
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.78);
  font-weight: 800;
  cursor:pointer;
}
.sp-tab.isActive{
  background: rgba(70,130,255,0.26);
  border-color: rgba(70,130,255,0.45);
}

.sp-modalBody{
  padding: 12px 14px 6px;
}

.sp-detailSlots{
  display:flex;
  flex-direction: column;
  gap: 10px;
}

.sp-detailSlot{
  display:flex;
  gap: 12px;
  align-items:center;
  padding: 10px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04);
  cursor: pointer;
}
.sp-detailSlot:hover{
  background: rgba(255,255,255,0.06);
  border-color: rgba(255,255,255,0.16);
}

.sp-detailSlotPreview{
  width: 72px;
  height: 72px;
  border-radius: 12px;
  border: 1px dashed rgba(255,255,255,0.16);
  background: rgba(0,0,0,0.20);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow: hidden;
  flex: 0 0 auto;
}

.sp-detailSlotPreview img{
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.sp-detailSlotPlus{
  font-size: 28px;
  line-height: 1;
  color: rgba(255,255,255,0.35);
  font-weight: 800;
}

.sp-detailSlotText{ min-width: 0; }
.sp-detailSlotLabel{ font-weight: 900; color: rgba(255,255,255,0.90); }
.sp-detailSlotSub{ font-size: 12px; color: rgba(255,255,255,0.50); margin-top: 2px; }

.sp-slotMenu{
  position: fixed;
  z-index: 1000;
  min-width: 180px;
  padding: 8px;
  border-radius: 14px;
  background: rgba(12,16,26,0.96);
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 18px 45px rgba(0,0,0,0.55);

}


.sp-slotMenu button{
  width: 100%;
  text-align: left;
  padding: 10px 10px;
  border-radius: 10px;
  background: transparent;
  border: 0;
  color: rgba(255,255,255,0.86);
  cursor: pointer;
  font-weight: 800;
}

.sp-slotMenu button:hover{ background: rgba(255,255,255,0.07); }

.sp-slotMenuSep{ height: 1px; margin: 6px 0; background: rgba(255,255,255,0.10); }

/* Portal menu (fixed overlay; avoids clipping inside containers) */
.sp-slotMenuPortal{
  position: fixed;
  z-index: 10050;
  width: 210px;
  padding: 10px;
  border-radius: 16px;
  background: rgba(8,10,16,0.84);
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 16px 60px rgba(0,0,0,0.55);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}
.sp-slotMenuPortal button{
  display: block;
  width: 100%;
  padding: 10px 12px;
  border-radius: 12px;
  border: 0;
  background: transparent;
  color: rgba(255,255,255,0.92);
  font-weight: 700;
  text-align: left;
  cursor: pointer;
}
.sp-slotMenuPortal button:hover{ background: rgba(255,255,255,0.07); }
.sp-slotMenuPortal button:disabled{ opacity: 0.45; cursor: not-allowed; }

/* URL modal */
@keyframes spFadeIn{ from{opacity:0;} to{opacity:1;} }
@keyframes spPopIn{ from{opacity:0; transform: translateY(8px) scale(0.98);} to{opacity:1; transform: translateY(0) scale(1);} }

.sp-urlModalOverlay{
  animation: spFadeIn 160ms ease-out;
  position: fixed;
  inset: 0;
  z-index: 10040;
  background: rgba(0,0,0,0.45);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
}
.sp-urlModal{
  animation: spPopIn 180ms cubic-bezier(0.2,0.9,0.2,1);
  width: min(640px, calc(100vw - 48px));
  border-radius: 22px;
  background: rgba(10,12,18,0.88);
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 22px 90px rgba(0,0,0,0.65);
  padding: 18px;
}
.sp-urlModalHead{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 14px;
}
.sp-urlModalTitle{
  font-size: 22px;
  font-weight: 900;
  color: rgba(255,255,255,0.95);
}
.sp-urlModalInput{
  width: 100%;
  max-width: 100%;
  height: 54px;
  border-radius: 16px;
  border: 1px solid rgba(102,158,255,0.35);
  background: rgba(6,10,18,0.70);
  color: rgba(255,255,255,0.95);
  padding: 0 16px;
  outline: none;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
/* allow full URL view when user drags/uses arrows */
.sp-urlModalInput:focus{ overflow-x: auto; }
.sp-urlModalInput:focus{ border-color: rgba(102,158,255,0.65); box-shadow: 0 0 0 4px rgba(102,158,255,0.14); }
.sp-urlModalActions{
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
  margin-top: 16px;
}

.sp-modalActions{
  display:flex;
  justify-content:flex-end;
  gap: 10px;
  padding: 10px 14px 14px;
  border-top: 1px solid rgba(255,255,255,0.08);
}

.sp-hiddenInput{ display:none; }

@media (max-width: 1100px){
  .sp-grid{ grid-template-columns: 1fr; }
  .sp-preview{ min-height: unset; }
}

/* ===== Studio picker modal ("перейти") ===== */

.sp-studioOverlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  display:flex;
  align-items: center;
  justify-content: center;
  padding: 18px;
  z-index: 80;
}

.sp-studioModal{
  width: min(1120px, 96vw);
  max-height: calc(100vh - 80px);
  overflow: hidden;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(10,14,26,0.92);
  box-shadow: 0 28px 90px rgba(0,0,0,0.70);
}

.sp-studioHead{
  display:flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 12px;
  padding: 16px 18px;
  border-bottom: 1px solid rgba(255,255,255,0.08);
}

.sp-studioTitle{ font-weight: 900; font-size: 22px; color: rgba(255,255,255,0.92); }
.sp-studioSub{ margin-top: 6px; color: rgba(255,255,255,0.55); font-size: 13px; }

.sp-studioClose{
  appearance: none;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.90);
  border-radius: 12px;
  width: 40px;
  height: 40px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size: 22px;
  cursor: pointer;
}
.sp-studioClose:hover{ background: rgba(255,255,255,0.08); }

.sp-studioGrid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
  padding: 16px;
  max-height: calc(100vh - 170px);
  overflow: auto;
}

.sp-studioCard{
  position: relative;
  height: 180px;
  border-radius: 18px;
  overflow: hidden;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.22);
  cursor: pointer;
  padding: 0;
  text-align: left;
}

.sp-studioCard:hover{ border-color: rgba(255,255,255,0.18); }

.sp-studioCardMedia{
  position:absolute;
  inset: 0;
  background: radial-gradient(120% 120% at 50% 50%, rgba(255,255,255,0.07), rgba(0,0,0,0.30));
  display:flex;
  align-items:center;
  justify-content:center;
}

.sp-studioCardLetter{
  width: 56px;
  height: 56px;
  border-radius: 16px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight: 900;
  font-size: 26px;
  color: rgba(255,255,255,0.92);
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.18);
  box-shadow: 0 18px 40px rgba(0,0,0,0.45);
}

.sp-studioCardBar{
  position:absolute;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 14px 14px;
  background: linear-gradient(180deg, rgba(0,0,0,0.00), rgba(0,0,0,0.60));
}

.sp-studioCardName{
  font-weight: 900;
  font-size: 18px;
  color: rgba(255,255,255,0.92);
}

@media (max-width: 920px){
  .sp-studioGrid{ grid-template-columns: 1fr; }
  .sp-studioCard{ height: 160px; }
}



/* ==== PATCH: details sidebar height & 5 full cards ==== */
.sp-detailsSidebar{
  min-height: 0;
  max-height: none;
  height: 100%;
}

.sp-detailsSlots{
  padding-right: 2px;
}

.sp-detailsSlot{
  padding: 8px;
  gap: 6px;
  border-radius: 14px;
}

.sp-detailsSlotLabel{
  font-size: 11px;
  line-height: 1.05;
}

.sp-detailsSlotPreview{
  /* compact preview box */
  aspect-ratio: auto;
  height: 52px;
}

.sp-detailsSlotPlus{
  font-size: 26px;
}

/* keep menu inside compact slot */
.sp-slotMenuInline{
  top: 38px;
}



/* Ensure 5 cards are fully visible (no half card) */
.sp-detailsSlots{
  flex: 1 1 auto;
  overflow: hidden;
}

.sp-detailsSlot{
  flex: 1 1 0;
  min-height: 0; /* allow exact fit to card height */
}


/* Slot menu: open upwards near bottom */
.sp-slotMenuInline.isUp{
  top: auto;
  bottom: 46px;
}


/* Chat highlight stronger when target selected */
.sp-cardChat.isActive{
  border-color: rgba(255,255,255,0.18);
}
.sp-cardChat.is-model.isActive{
  box-shadow: 0 0 0 1px rgba(84,140,255,0.35), 0 0 22px rgba(84,140,255,0.18);
}
.sp-cardChat.is-location.isActive{
  box-shadow: 0 0 0 1px rgba(95,214,145,0.35), 0 0 22px rgba(95,214,145,0.18);
}


/* Accent buttons (chat + details) */
.sp-btn.isModel{
  background: linear-gradient(180deg, rgba(70,140,255,0.30), rgba(70,140,255,0.16));
  border-color: rgba(110,170,255,0.40);
  box-shadow: 0 18px 50px rgba(60,120,255,0.18);
}
.sp-btn.isLocation{
  background: linear-gradient(180deg, rgba(60,220,140,0.26), rgba(60,220,140,0.14));
  border-color: rgba(90,255,170,0.35);
  box-shadow: 0 18px 50px rgba(60,220,140,0.14);
}

/* URL modal (instead of window.prompt) */
.sp-urlBackdrop{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}
.sp-urlModal{
  width: min(640px, calc(100vw - 48px));
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(15,18,28,0.92);
  box-shadow: 0 40px 120px rgba(0,0,0,0.65);
  padding: 18px;
}
.sp-urlHead{
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 12px;
}
.sp-urlTitle{
  font-size: 20px;
  font-weight: 900;
  color: rgba(255,255,255,0.92);
}
.sp-urlClose{
  appearance:none;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.85);
  border-radius: 12px;
  width: 40px;
  height: 40px;
  cursor: pointer;
}
.sp-urlInput{
  width: 100%;
  height: 54px;
  border-radius: 14px;
  border: 1px solid rgba(100,160,255,0.35);
  outline: none;
  padding: 0 16px;
  background: rgba(255,255,255,0.05);
  color: rgba(255,255,255,0.90);
  box-shadow: 0 0 0 3px rgba(80,140,255,0.10);
}
.sp-urlActions{
  display:flex;
  gap: 14px;
  margin-top: 14px;
}
.sp-urlBtn{
  flex: 1;
  height: 52px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.86);
  font-weight: 900;
  text-transform: lowercase;
  cursor: pointer;
}
.sp-urlBtnOk{
  border-color: rgba(120,160,255,0.40);
  background: linear-gradient(180deg, rgba(90,120,255,0.95), rgba(70,90,255,0.78));
  box-shadow: 0 20px 60px rgba(80,110,255,0.25);
}

/* Studio picker overlay from ScenePage */
.sp-studioPickerBackdrop{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(10px);
  display:flex;
  align-items: flex-start;
  justify-content: center;
  padding: 22px;
  z-index: 10000;
}
.sp-studioPicker{
  width: min(1180px, calc(100vw - 22px));
  max-height: calc(100vh - 44px);
  overflow: auto;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(15,18,28,0.92);
  box-shadow: 0 40px 120px rgba(0,0,0,0.65);
  padding: 18px 18px 22px;
}
.sp-studioPickerHead{
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 12px;
}
.sp-studioPickerTitle{
  font-size: 20px;
  font-weight: 900;
  color: rgba(255,255,255,0.92);
}
.sp-studioPickerClose{
  appearance:none;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.85);
  border-radius: 12px;
  width: 40px;
  height: 40px;
  cursor: pointer;
}
.sp-studioPickerSub{
  margin-top: 8px;
  margin-bottom: 14px;
  color: rgba(255,255,255,0.62);
}
.sp-studioPickerGrid{
  display:grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 14px;
}
.sp-studioCard{
  appearance:none;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.05);
  border-radius: 16px;
  overflow: hidden;
  cursor: pointer;
  display:flex;
  text-align:left;
  padding: 0;
}
.sp-studioCardMedia{
  width: 160px;
  min-width: 160px;
  height: 110px;
  display:flex;
  align-items:center;
  justify-content:center;
  background: rgba(255,255,255,0.05);
}
.sp-studioCardLetter{
  font-size: 32px;
  font-weight: 1000;
  color: rgba(255,255,255,0.88);
  width: 54px;
  height: 54px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius: 16px;
  background: rgba(0,0,0,0.25);
  border: 1px solid rgba(255,255,255,0.12);
}
.sp-studioCardBody{
  flex: 1;
  padding: 14px 14px 12px;
}
.sp-studioCardTitle{
  font-weight: 950;
  color: rgba(255,255,255,0.92);
  font-size: 18px;
}
.sp-studioCardDesc{
  margin-top: 6px;
  color: rgba(255,255,255,0.62);
  font-size: 13px;
  line-height: 1.25;
}
.sp-studioCard:hover{
  border-color: rgba(120,160,255,0.25);
  background: rgba(255,255,255,0.07);
}

/* simple accent variations */
.sp-studioCardMedia.accent-cyan{ box-shadow: inset 0 0 0 2px rgba(80,160,255,0.18); }
.sp-studioCardMedia.accent-green{ box-shadow: inset 0 0 0 2px rgba(70,220,140,0.18); }
.sp-studioCardMedia.accent-orange{ box-shadow: inset 0 0 0 2px rgba(255,170,70,0.18); }
.sp-studioCardMedia.accent-pink{ box-shadow: inset 0 0 0 2px rgba(255,90,200,0.18); }
.sp-studioCardMedia.accent-purple{ box-shadow: inset 0 0 0 2px rgba(160,90,255,0.18); }


/* =============================== */
/* URL MODAL FIXED (FINAL)        */
/* =============================== */

.url-modal {
  width: 480px;
  max-width: 92vw;
  padding: 24px;

  box-sizing: border-box;
  overflow: hidden;

  border-radius: 20px;
}

.url-modal input {
  display: block;

  width: 100%;
  box-sizing: border-box;

  padding: 14px 18px;

  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.15);

  background: rgba(10,15,30,0.95);
  color: #fff;

  font-size: 14px;
}



/* =============================== */
/* URL MODAL — FORCE NO OVERFLOW   */
/* =============================== */
.sp-urlModal{
  box-sizing: border-box !important;
  overflow: hidden;
}

.sp-urlModalInput{
  display: block;
  box-sizing: border-box !important;
  width: 100% !important;
  max-width: 100% !important;
  min-width: 0 !important;
}

/* if some global styles add margin */
.sp-urlModalInput{
  margin: 0 !important;
}


/* Zoom overlay for preview images (model/location) */
.sp-imgClickable{
  cursor: zoom-in;
}

.sp-zoomOverlay{
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 28px;
  background: rgba(0,0,0,0.62);
  backdrop-filter: blur(6px);
  animation: spZoomFadeIn 180ms ease-out both;
}

.sp-zoomImg{
  max-width: calc(100vw - 56px);
  max-height: calc(100vh - 56px);
  object-fit: contain;
  border-radius: 14px;
  box-shadow: 0 20px 80px rgba(0,0,0,0.55);
  animation: spZoomPopIn 220ms cubic-bezier(.2,.9,.2,1) both;
}

@keyframes spZoomFadeIn{
  from{ opacity: 0; }
  to{ opacity: 1; }
}

@keyframes spZoomPopIn{
  from{ transform: scale(.92); opacity: .65; }
  to{ transform: scale(1); opacity: 1; }
}


/* --- Scene format selector (model/location) --- */
.sp-formatBar{
  margin: 10px 14px 0;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.14);
  padding: 10px 12px;
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}
.sp-formatBar.isModel{ --spFmtAccent: rgba(90,140,255,0.95); }
.sp-formatBar.isLocation{ --spFmtAccent: rgba(80,220,150,0.95); }
.sp-formatBar:not(.isModel):not(.isLocation){ --spFmtAccent: rgba(255,255,255,0.22); }

.sp-formatLabel{
  font-weight: 900;
  text-transform: lowercase;
  color: rgba(255,255,255,0.78);
  letter-spacing: 0.2px;
}

.sp-formatPills{
  display: flex;
  gap: 8px;
  align-items: center;
}

.sp-formatPill{
  height: 34px;
  min-width: 64px;
  padding: 0 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.18);
  color: rgba(255,255,255,0.75);
  font-weight: 800;
  cursor: pointer;
  transition: transform 0.12s ease, border-color 0.12s ease, background 0.12s ease, opacity 0.12s ease;
}
.sp-formatPill:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,0.18); }
.sp-formatPill.isOn{
  border-color: color-mix(in srgb, var(--spFmtAccent) 70%, rgba(255,255,255,0.10));
  background: color-mix(in srgb, var(--spFmtAccent) 22%, rgba(0,0,0,0.20));
  box-shadow: 0 0 0 1px rgba(255,255,255,0.06) inset;
  color: rgba(255,255,255,0.92);
}
.sp-formatPill:disabled{
  opacity: 0.55;
  cursor: default;
  transform: none;
}

.sp-formatHint{
  margin-left: auto;
  color: rgba(255,255,255,0.40);
  font-size: 12px;
  white-space: nowrap;
}

@media (max-width: 1100px){
  .sp-formatHint{ margin-left: 0; white-space: normal; }
}
